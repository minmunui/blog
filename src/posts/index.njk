---
layout: layouts/base.njk
title: Blog Archive
---

<div class="container max-w-8xl py-6 lg:py-10">
  <div class="flex flex-col items-start gap-4 md:flex-row md:justify-between md:gap-8">
    <div class="flex-1 space-y-4">
      <h1 class="inline-block font-extrabold text-4xl tracking-tight lg:text-5xl">Blog</h1>
      <p class="text-xl text-muted-foreground">
        잡담, 기술, 가이드 등.
      </p>
    </div>
  </div>
  <hr class="my-8" />
  
  <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
    <!-- Sidebar: Search & Filters -->
    <div class="md:col-span-1 space-y-8">
        <!-- Search -->
        <div class="space-y-3">
            <h3 class="font-semibold tracking-tight text-lg">Search</h3>
            <div class="relative">
                <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-3 top-3 h-4 w-4 text-muted-foreground" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                <input type="text" id="search-input" placeholder="Search titles..." class="flex h-10 w-full rounded-md border border-input bg-background pl-9 pr-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
            </div>
        </div>

        <!-- Category Dropdown -->
        <div class="space-y-3">
            <h3 class="font-semibold tracking-tight text-lg">Category</h3>
            <select id="category-select" class="flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1">
                <option value="all">All Categories</option>
                <!-- Manually adding categories for now or ensuring they exist in posts -->
                {% set categories = [] %}
                {% for post in collections.posts %}
                    {% if post.data.category %}
                        {% set categories = (categories.push(post.data.category), categories) %}
                    {% endif %}
                {% endfor %}
                {% set uniqueCategories = [] %}
                {% for cat in categories %}
                    {% if cat not in uniqueCategories %}
                        {% set uniqueCategories = (uniqueCategories.push(cat), uniqueCategories) %}
                        <option value="{{ cat }}">{{ cat }}</option>
                    {% endif %}
                {% endfor %}
                <!-- Fallback if no categories are found in frontmatter -->
                {% if uniqueCategories.length == 0 %}
                    <option value="Uncategorized">Uncategorized</option>
                    <option value="Development">Development</option>
                    <option value="Design">Design</option>
                    <option value="Productivity">Productivity</option>
                {% endif %}
            </select>
        </div>

        <!-- Tag Toggles -->
        <div class="space-y-3">
             <div class="flex items-center justify-between">
                <h3 class="font-semibold tracking-tight text-lg">Tags</h3>
                <button id="clear-tags" class="text-xs text-muted-foreground hover:text-foreground hidden">Clear all</button>
            </div>
            <div class="flex flex-wrap gap-2" id="tag-container">
                {% for tag, posts in collections %}
                    {% if tag != "all" and tag != "posts" %}
                        <button class="tag-toggle inline-flex items-center rounded-md border px-3 py-1 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-input bg-transparent hover:bg-accent hover:text-accent-foreground data-[state=on]:bg-primary data-[state=on]:text-primary-foreground" data-tag="{{ tag }}" data-state="off">
                            {{ tag }}
                        </button>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Post List -->
    <div class="md:col-span-3">
        <div class="grid gap-6 sm:grid-cols-2" id="post-grid">
            {% for post in collections.posts | reverse %}
             <article class="post-item group relative flex flex-col space-y-0 border rounded-xl overflow-hidden hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors" 
                      data-title="{{ post.data.title | lower }}" 
                      data-tags="{{ (post.data.tags or []) | join(',') }}"
                      data-category="{{ post.data.category | default('Uncategorized') }}">
                {% if post.data.thumbnail %}
                    <div class="aspect-video w-full overflow-hidden rounded-t-xl border-b bg-muted">
                        <img src="{{ post.data.thumbnail | url }}" alt="{{ post.data.title }}" class="h-full w-full object-cover transition-transform duration-200 group-hover:scale-105" />
                    </div>
                {% else %}
                    <div class="aspect-video w-full overflow-hidden rounded-t-xl border-b bg-muted flex items-center justify-center text-muted-foreground">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
                    </div>
                {% endif %}
                <div class="flex flex-col space-y-2 p-4">
                    <div class="flex items-center gap-2">
                         <span class="inline-flex items-center rounded-sm bg-secondary px-2 py-0.5 text-xs font-medium text-secondary-foreground">
                            {{ post.data.category | default('Uncategorized') }}
                         </span>
                         <span class="text-xs text-muted-foreground">{{ post.date | dateReadable }}</span>
                    </div>
                    <h2 class="text-xl font-bold line-clamp-2">{{ post.data.title }}</h2>
                    {% if post.data.description %}
                        <p class="text-sm text-muted-foreground line-clamp-3">{{ post.data.description }}</p>
                    {% endif %}
                </div>
                <a href="{{ post.url | url }}" class="absolute inset-0"><span class="sr-only">View Article</span></a>
            </article>
            {% endfor %}
            <div id="no-results" class="hidden text-center text-muted-foreground py-10 w-full col-span-2">
                <div class="flex flex-col items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground/50"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    <p class="text-lg font-medium">No posts found</p>
                    <p class="text-sm">Try adjusting your filters or search query.</p>
                </div>
            </div>
        </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const searchInput = document.getElementById('search-input');
    const categorySelect = document.getElementById('category-select');
    const tagToggles = document.querySelectorAll('.tag-toggle');
    const clearTagsBtn = document.getElementById('clear-tags');
    const posts = document.querySelectorAll('.post-item');
    const noResults = document.getElementById('no-results');
    
    let activeTags = new Set();
    let currentCategory = 'all';
    let searchQuery = '';

    function filterPosts() {
        let visibleCount = 0;

        posts.forEach(post => {
            const title = post.getAttribute('data-title');
            const category = post.getAttribute('data-category');
            const tags = post.getAttribute('data-tags').split(',');
            
            // Search Logic
            const matchSearch = title.includes(searchQuery);
            
            // Category Logic
            const matchCategory = currentCategory === 'all' || category === currentCategory;

            // Tag Logic (OR logic: match any of the active tags, if no tags active, match all)
            let matchTags = true;
            if (activeTags.size > 0) {
                matchTags = tags.some(tag => activeTags.has(tag));
            }

            if (matchSearch && matchCategory && matchTags) {
                post.classList.remove('hidden');
                visibleCount++;
            } else {
                post.classList.add('hidden');
            }
        });

        if (visibleCount === 0) {
            noResults.classList.remove('hidden');
        } else {
            noResults.classList.add('hidden');
        }
    }

    // Search Event
    searchInput.addEventListener('input', (e) => {
        searchQuery = e.target.value.toLowerCase();
        filterPosts();
    });

    // Category Event
    categorySelect.addEventListener('change', (e) => {
        currentCategory = e.target.value;
        filterPosts();
    });

    // Tag Toggle Logic
    tagToggles.forEach(btn => {
        btn.addEventListener('click', () => {
            const tag = btn.getAttribute('data-tag');
            const currentState = btn.getAttribute('data-state');

            if (currentState === 'off') {
                btn.setAttribute('data-state', 'on');
                activeTags.add(tag);
            } else {
                btn.setAttribute('data-state', 'off');
                activeTags.delete(tag);
            }

            // Show/Hide Clear Button
            if (activeTags.size > 0) {
                clearTagsBtn.classList.remove('hidden');
            } else {
                clearTagsBtn.classList.add('hidden');
            }

            filterPosts();
        });
    });

    // Clear Tags Logic
    clearTagsBtn.addEventListener('click', () => {
        activeTags.clear();
        tagToggles.forEach(btn => btn.setAttribute('data-state', 'off'));
        clearTagsBtn.classList.add('hidden');
        filterPosts();
    });
});
</script>
